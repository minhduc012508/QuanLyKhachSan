--1.	In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” sản xuất.
CREATE VIEW TQ_SANXUAT as
SELECT MASP, TENSP
FROM SANPHAM
WHERE NUOCSX = 'TRUNG QUOC'
--2.	In ra danh sách các sản phẩm (MASP, TENSP) có đơn vị tính là “cay”, ”quyen”.
CREATE VIEW DONVI_CAY_QUYEN as
SELECT MASP, TENSP
FROM SANPHAM
WHERE Donvi IN('CAY', 'QUYEN')
--3.	In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” hoặc “Thai Lan” sản xuất có giá từ 30.000 đến 40.000.
CREATE VIEW SANPHAM_TQ_TL as
SELECT MASP, TENSP, NUOCSX
FROM SANPHAM
WHERE (NUOCSX = 'TRUNG QUOC' OR NUOCSX = 'THAI LAN') AND GIA BETWEEN 30000 AND 40000
--4.	In ra các số hóa đơn, trị giá hóa đơn bán ra trong ngày 2/1/2021 và ngày 10/5/2021.
CREATE VIEW HOADON_0201_1005 as
SELECT SOHD, TONGHOADON
FROM HOADON
WHERE NGHD >= '2/1/2021' AND NGHD <= '5/10/2021'
--5.	In ra các số hóa đơn, trị giá hóa đơn trong tháng 1/2021, sắp xếp theo ngày (tăng dần) và trị giá của hóa đơn (giảm dần).
CREATE VIEW HOADON_SAPXEP_T1 as
SELECT SOHD, TONGHOADON
FROM HOADON
WHERE MONTH(NGHD) = 1 AND YEAR(NGHD) = 2021
ORDER BY NGHD ASC, TONGHOADON DESC
--6.	Tìm khách hàng (MAKH, HOTEN) có số lần mua hàng nhiều nhất. 
CREATE VIEW KHACHHANG_MAXMUA as
SELECT MAKH, HOTEN
FROM KHACHHANG
WHERE MAKH = (SELECT TOP 1 MAKH
FROM HOADON
GROUP BY MAKH
ORDER BY COUNT(DISTINCT SOHD) DESC)
--7.	Tháng mấy trong năm 2006, doanh số bán hàng cao nhất ?
CREATE VIEW MAXDoanhThu_2006 as
SELECT TOP 1 MONTH(NGHD) AS THANG_DOANHSO_MAX
FROM HOADON
WHERE YEAR(NGHD) = 2021
GROUP BY MONTH(NGHD)
ORDER BY SUM(TONGHOADON) DESC
--8.	Tìm sản phẩm (MASP, TENSP) có tổng số lượng bán ra thấp nhất trong năm 2006.
CREATE VIEW SANPHAM_BanMIN_2006 as
SELECT MASP, TENSP
FROM SANPHAM
WHERE MASP = (SELECT TOP 1 MASP
FROM CTHD
GROUP BY MASP
ORDER BY SUM(SL) DESC)
--9.	* In ra danh sách 3 khách hàng có doanh số cao nhất (sắp xếp theo kiểu xếp hạng).
CREATE VIEW KHACHHANG_3MAXDoanhSo as
SELECT TOP 3 MAKH, HOTEN
FROM KHACHHANG
ORDER BY DOANHSO DESC
--10.	Tìm họ tên khách hàng đã mua hóa đơn có trị giá cao nhất.
CREATE VIEW KHACHHANG_HOADONMAX AS
SELECT HOTEN
FROM KHACHHANG K INNER JOIN HOADON H
ON K.MAKH = H.MAKH 
AND SOHD = (SELECT SOHD
FROM HOADON
WHERE TONGHOADON = (SELECT MAX(TONGHOADON)
FROM HOADON))
--11.	Tính tổng số sản phẩm của từng nước sản xuất.
CREATE VIEW TONGSP_NUOCSX AS
SELECT NUOCSX, COUNT(DISTINCT MASP) AS TONGSOSANPHAM
FROM SANPHAM
GROUP BY NUOCSX